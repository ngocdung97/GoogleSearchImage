<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Document</title>
</head>

<body>
  <script async src="https://cse.google.com/cse.js?cx=e7b5ff1a9b019e32b"></script>
    <h3>Thêm Image</h3>
    <div>
        <div class="gcse-search" data-newWindow="true" 
        data-imageSearchLayout="popup" data-enableImageSearch="true" 
        data-defaultToImageSearch="true">
        </div>
</body>

</html>

<!-- <html>
  <head>
    <script
      src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"
      type="text/javascript"
    ></script>
    <title>Custom Search JSON API Example</title>
  </head>

  <body>
    <input id="txtSearch" type="text" />
    <input type="button" value="Tìm kiếm" id="btnSearch" />
    <div id="content"></div>
    <table id="tableSearch">
      <tbody></tbody>
    </table>
    <script type="text/javascript">
      let currentPage = 1;
      $(document).ready(function () {
        //your code here
        $("#btnSearch").click(function () {
          console.log("hihihi");
          search();
        });

        function search() {
          var searchText = $("#txtSearch")[0].value;
          currentPage = 1;
          var res = httpGet(
            // &imgSize=medium
            `https://www.googleapis.com/customsearch/v1/?key=AIzaSyCAUEYad0e8NqWcqUdQjFCDW2c1mEflKD0&cx=e7b5ff1a9b019e32b&q=${searchText}
            &SearchTypeEnum=IMAGE
            &Safe=ACTIVE
            `
          );
          console.log(res);
          var data = JSON.parse(res).items.map((x) => {
            if (x.pagemap !== JSON.parse(res).items[0]) return x.pagemap;
          });
          console.log(data);

          hndlr(data);
        }

        function hndlr(response) {
          debugger;
          for (var i = 0; i < response.length; i++) {
            // var item = response.[i];
            // in production code, item.htmlTitle should have the HTML entities escaped.
            if ("cse_thumbnail" in response[i]) {
              $("#tableSearch > tbody").append(`<tr><td> <img
                  src="${response[i]?.cse_thumbnail[0]?.src}"
                  alt=""
                /></td></tr>`);
            }
          }
        }

        function httpGet(theUrl) {
          var xmlHttp = new XMLHttpRequest();
          xmlHttp.open("GET", theUrl, false); // false for synchronous request
          xmlHttp.send(null);
          return xmlHttp.responseText;
        }
        $(window).scroll(function () {
          if (
            $(window).scrollTop() ==
            $(document).height() - $(window).height()
          ) {
            debugger;
            var searchText = $("#txtSearch")[0].value;
            currentPage = currentPage;
            var res = httpGet(
              `https://www.googleapis.com/customsearch/v1/?key=AIzaSyAU4U99ZyPBlchyhhIfQe_-uPR7u3Kp204&cx=e7b5ff1a9b019e32b&q=${searchText}
              &SearchTypeEnum=IMAGE
              &Safe=ACTIVE
              &Start=${currentPage}
              `
            );
            console.log(res);
            var data = JSON.parse(res).items.map((x) => {
              if (x.pagemap !== JSON.parse(res).items[0]) return x.pagemap;
            });
            console.log(data);

            hndlr(data);
            // ajax call get data from server and append to the div
          }
        });
      });
    </script>
  </body>
</html> -->
